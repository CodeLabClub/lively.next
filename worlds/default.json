{"id":"EmptyWorld_C4E39173_2F0B_45D2_A13C_ECEDC184554A","snapshot":{"EmptyWorld_C4E39173_2F0B_45D2_A13C_ECEDC184554A":{"rev":175574,"props":{"extent":{"key":"extent","value":"__lv_expr__:{pt}:lively.graphics/geometry-2d.js:pt(1440.0,799.0)"},"name":{"key":"name","value":"world"},"origin":{"key":"origin","value":"__lv_expr__:{pt}:lively.graphics/geometry-2d.js:pt(0.0,0.0)"},"position":{"key":"position","value":"__lv_expr__:{pt}:lively.graphics/geometry-2d.js:pt(0.0,0.0)"},"styleClasses":{"key":"styleClasses","value":["EmptyWorld","World","Morph","morph"]},"submorphs":{"key":"submorphs","value":[{"__ref__":true,"id":"Image_C194BC51_1AD0_480B_AC33_F15E751CA996","rev":171939}]},"_tickingScripts":{"key":"_tickingScripts","value":[]},"attributeConnections":{"key":"attributeConnections"}},"lively.serializer-class-info":{"className":"EmptyWorld","module":{"package":{"name":"EmptyWorld","version":null},"pathInPackage":"index.js"}}},"Image_C194BC51_1AD0_480B_AC33_F15E751CA996":{"rev":171939,"props":{"acceptsDrops":{"key":"acceptsDrops","value":false},"extent":{"key":"extent","value":"__lv_expr__:{pt}:lively.graphics/geometry-2d.js:pt(175.3,167.0)"},"fill":{"key":"fill","value":null},"name":{"key":"name","value":"background-logo"},"opacity":{"key":"opacity","value":0.1},"origin":{"key":"origin","value":"__lv_expr__:{pt}:lively.graphics/geometry-2d.js:pt(87.0,79.0)"},"position":{"key":"position","value":"__lv_expr__:{pt}:lively.graphics/geometry-2d.js:pt(716.9,378.0)"},"reactsToPointer":{"key":"reactsToPointer","value":false},"scale":{"key":"scale","value":4.7844311377245505},"scroll":{"key":"scroll","value":"__lv_expr__:{pt}:lively.graphics/geometry-2d.js:pt(0.0,0.0)"},"styleClasses":{"key":"styleClasses","value":["Image","Morph","morph"]},"submorphs":{"key":"submorphs","value":[]},"imageUrl":{"key":"imageUrl","value":"http://localhost:9011/lively.morphic/lively-web-logo-small.svg"},"naturalExtent":{"key":"naturalExtent","value":null},"autoResize":{"key":"autoResize","value":true},"_tickingScripts":{"key":"_tickingScripts","value":[]},"attributeConnections":{"key":"attributeConnections"}},"lively.serializer-class-info":{"className":"Image","module":{"package":{"name":"lively.morphic","version":"0.1.0"},"pathInPackage":"morph.js"}}}},"requiredVersion":"~0.1","packages":{"local://lively-object-modules/":{"EmptyWorld":{"package.json":"{\n  \"name\": \"EmptyWorld\",\n  \"version\": \"0.1.0\",\n  \"lively\": {\n    \"isObjectPackage\": true\n  }\n}","index.js":"import { World } from \"lively.morphic\";\nimport { arr } from \"lively.lang/index.js\";\n\nexport default class EmptyWorld extends World {\n\n  onLoad() {\n    this.relayout();\n  }\n\n  relayout() {\n    let bounds = this.windowBounds();\n    if (!this.extent.equals(bounds.extent()))\n      this.extent = bounds.extent();\n    this.relayoutLogo();\n  }\n\n  relayoutLogo() {\n    let l = this.get(\"background-logo\");\n    if (!l) return\n    l.reactsToPointer = false;\n    let bounds = this.windowBounds();\n    let {width, height} = l;\n    l.scale = 1\n    l.scale = Math.min(bounds.width / width, bounds.height / height)\n    l.center = bounds.center();\n  }\n\n  onWindowResize(evt) {\n    super.onWindowResize(evt);\n    this.relayout();\n  }\n\n}\n\n"},"save-world-dialog":{"package.json":"{\n  \"name\": \"save-world-dialog\",\n  \"version\": \"0.1.0\",\n  \"lively\": {\n    \"isObjectPackage\": true\n  }\n}","index.js":"import { Morph, show, CenteredTilingLayout } from \"lively.morphic\";\nimport { resource } from \"lively.resources/index.js\";\nimport { connect, disconnect, disconnectAll } from \"lively.bindings/index.js\";\nimport { pt, Color } from \"lively.graphics/index.js\";\nimport LoadingIndicator from \"lively.morphic/components/loading-indicator.js\";\nimport { promise } from \"lively.lang/index.js\";\nimport { AbstractPrompt } from \"lively.morphic/components/prompts.js\";\n\nexport default class SaveWorldDialog extends AbstractPrompt {\n\n  static get properties() {\n\n    return {\n\n      isEpiMorph: {get() { return true}},\n\n      worldName: {\n        derived: true, after: [\"submorphs\"],\n        get() { return this.ui.nameInput.textString; },\n        set(name) { this.ui.nameInput.textString = name; }\n      },\n\n      ui: {\n        derived: true, readOnly: true, after: [\"submorphs\"],\n        get() {\n          return {\n            label: this.getSubmorphNamed(\"save-dialog-label\"),\n            cancelButton: this.getSubmorphNamed(\"cancelButton\"),\n            okButton: this.getSubmorphNamed(\"okButton\"),\n            nameInput: this.getSubmorphNamed(\"name input\"),\n            nameLabel: this.getSubmorphNamed(\"name label\"),\n            destinationChooser: this.getSubmorphNamed(\"destination chooser\"),\n            destinationChooserLabel: this.getSubmorphNamed(\"destination chooser label\")\n          }\n        }\n      },\n    }\n\n  }\n\n  alignInWorld(world = this.world()) {\n    world.addMorph(this);\n    let {width, height} = world.visibleBounds();\n    this.width = (width*1/2) - 5;\n    this.height = (height*1/2) - 10\n    this.center = world.visibleBounds().center();\n    return this;\n  }\n\n  reset() {\n    // this.reset();\n    // this.update();\n    // this.openInWorld()\n\n    this.layout = null;\n    this.clipMode = \"hidden\";\n\n    this.ui.label.fontColor = Color.white\n    this.ui.label.fontSize = 21;\n    this.ui.label.value = \"Save world\";\n    this.ui.label.fit()\n\n    connect(this, 'extent', this, 'relayout')\n    connect(this.ui.cancelButton, 'fire', this, 'reject');\n    connect(this.ui.okButton, 'fire', this, 'resolve');\n    \n    this.ui.destinationChooser.items = [\"local storage\", \"server\"];\n  }\n\n  activate() {\n    this.ui.nameInput.showHistItem(\"prev\"); // FIXME, last saved world name\n    return super.activate();\n  }\n\n  reject() {\n    super.reject({name: null, destination: null});\n  }\n\n  resolve() {\n    let name = this.ui.nameInput.input;\n    if (!name) return this.reject();\n    this.ui.nameInput.acceptInput();\n    let destination = this.ui.destinationChooser.selection\n    return super.resolve({name, destination});\n  }\n\n  focus() {\n    this.ui.nameInput.focus();\n  }\n\n  relayout() {\n    let bounds = this.innerBounds();\n    let {\n      label,\n      cancelButton,\n      okButton,\n      nameInput,\n      nameLabel,\n      destinationChooser,\n      destinationChooserLabel\n    } = this.ui;\n\n    label.topCenter = bounds.topCenter().addXY(0, 12);\n    okButton.bottomRight = bounds.bottomCenter().addXY(-12, -12);\n    cancelButton.bottomLeft = bounds.bottomCenter().addXY(12, -12);\n\n    nameLabel.topLeft = pt(20, label.bottom + 22);\n    destinationChooserLabel.topLeft = nameLabel.bottomLeft.addXY(0, 20);\n    \n    let labelIndent = Math.max(nameLabel.width, destinationChooser.width)\n\n    nameInput.leftCenter = pt(labelIndent + 10, nameLabel.center.y)\n    nameInput.width = bounds.width - nameInput.left- 20;\n\n    destinationChooser.leftCenter = pt(labelIndent + 10, destinationChooserLabel.center.y)\n  }\n\n  beforePublish() {\n    // disconnectAll(this);\n    this.reset();\n  }\n\n  worldResources() {\n    let r = resource(System.decanonicalize(\"lively.morphic/worlds/\"));\n    return r.dirList(1, {exclude: ea => !ea.name().endsWith(\".json\")})\n  }\n\n  resourceFor(name) {\n    return resource(System.decanonicalize(`lively.morphic/worlds/${name}.json`))\n  }\n\n}\n\n"}}},"preview":"data:image/png;base64,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"}